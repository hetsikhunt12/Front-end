<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>View Submissions</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">
  <div class="container mt-4">
    <h3>Submissions</h3>
    <a href="index.html" class="btn btn-outline-success mb-3">Back to Form</a>
    <input id="searchInput" class="form-control mb-3" placeholder="Search by name">
     
    <table class="table table-bordered bg-white">
      <thead class="table-success">
        <tr>
          <th>Name</th>
          <th>Phone</th>
          <th>Email</th>
          <th>Check-In</th>
          <th>Check-Out</th>
          <th>Adults</th>
          <th>Purpose</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody id="tableBody"></tbody>
    </table>

    <p id="noData" class="text-center text-muted"></p>
  </div>

  <script>
    class SubmissionViewer {
      constructor() {
        this.data = JSON.parse(sessionStorage.getItem("hotelData")) || [];
        this.tbody = document.getElementById("tableBody");
        this.noData = document.getElementById("noData");
        this.render(this.data);

        document.getElementById("searchInput")
          .addEventListener("input", e => this.search(e.target.value));
      }

      render(list) {
        this.tbody.innerHTML = "";
        if (list.length === 0) {
          this.noData.innerText = "No records found";
          return;
        }
        this.noData.innerText = "";

        list.forEach((r, index) => {
          this.tbody.innerHTML += `
            <tr>
              <td>${r.name}</td>
              <td>${r.phone}</td>
              <td>${r.email}</td>
              <td>${r.checkin}</td>
              <td>${r.checkout}</td>
              <td>${r.adults}</td>
              <td>${r.purpose}</td>
              <td>
                <button class="btn btn-sm btn-danger"
                  onclick="viewer.deleteRecord(${index})">
                  Delete
                </button>
              </td>
            </tr>`;
        });
      }

      search(text) {
        const filtered = this.data.filter(r =>
          r.name.toLowerCase().includes(text.toLowerCase())
        );
        this.render(filtered);
      }

      deleteRecord(index) {
        if (!confirm("Are you sure you want to delete this record?")) return;
        this.data.splice(index, 1);
        sessionStorage.setItem("hotelData", JSON.stringify(this.data));
        this.render(this.data);
      }
    }

    const viewer = new SubmissionViewer();
  </script>
</body>
</html>
